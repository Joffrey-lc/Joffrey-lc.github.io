

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="复现AA-IS/AA_SA/AA-SS_minVar/AA-SS_maxE/APS-EMW/CSI-Based">
  <meta name="author" content="Joffrey">
  <meta name="keywords" content="">
  <meta name="description" content="复现AA-IS&#x2F;AA_SA&#x2F;AA-SS_minVar&#x2F;AA-SS_maxE&#x2F;APS-EMW&#x2F;CSI-Based">
<meta property="og:type" content="article">
<meta property="og:title" content="CSI-Free相关文献代码复现">
<meta property="og:url" content="http://lcjoffrey.top/2022/04/24/reproductionofOnel/index.html">
<meta property="og:site_name" content="Joffrey&#39;s Blog">
<meta property="og:description" content="复现AA-IS&#x2F;AA_SA&#x2F;AA-SS_minVar&#x2F;AA-SS_maxE&#x2F;APS-EMW&#x2F;CSI-Based">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://mymarkdown-pic.oss-cn-chengdu.aliyuncs.com/img441/image-20220424145451687.png">
<meta property="og:image" content="https://mymarkdown-pic.oss-cn-chengdu.aliyuncs.com/img441/image-20220424175207762.png">
<meta property="og:image" content="https://mymarkdown-pic.oss-cn-chengdu.aliyuncs.com/img441/result2.jpg">
<meta property="article:published_time" content="2022-04-24T09:55:37.000Z">
<meta property="article:modified_time" content="2022-04-25T02:28:56.358Z">
<meta property="article:author" content="Joffrey">
<meta property="article:tag" content="Reproduction">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://mymarkdown-pic.oss-cn-chengdu.aliyuncs.com/img441/image-20220424145451687.png">
  
  <title>CSI-Free相关文献代码复现 - Joffrey&#39;s Blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      
        
          
          
          
        
        <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.min.css" />
      
      
        <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.css" />
      
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->

  
<link rel="stylesheet" href="/css/diy/shubiao.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"lcjoffrey.top","root":"/","version":"1.8.12","typing":{"enable":true,"typeSpeed":50,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":"§"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname"}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>

<script src="https://g.joyinshare.com/hc/ribbon.min.js" type="text/javascript"></script>

<body>

  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>花看半开，酒饮微醺</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-books"></i>
                科研
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/archives/">
                    
                    归档
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/">
                    
                    分类
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/tags/">
                    
                    标签
                  </a>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('https://mymarkdown-pic.oss-cn-chengdu.aliyuncs.com/img441/1638523690670.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="CSI-Free相关文献代码复现">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-04-24 17:55" pubdate>
        2022年4月24日 下午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      11k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      35 分钟
    </span>
  

  
  
    
      <!-- 不蒜子统计文章PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">CSI-Free相关文献代码复现</h1>
            
            <div class="markdown-body">
              <h1 id="OneL’s-CSI-Free-and-CSI-Based-Wireless-Energy-Transfer-Method-Reproduction"><a href="#OneL’s-CSI-Free-and-CSI-Based-Wireless-Energy-Transfer-Method-Reproduction" class="headerlink" title="OneL’s CSI-Free and CSI-Based Wireless Energy Transfer Method Reproduction"></a>OneL’s CSI-Free and CSI-Based Wireless Energy Transfer Method Reproduction</h1><p>参考OneL’s Github<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="https://github.com/onel2428/WEToverview
">[1]</span></a></sup>源码复现。</p>
<h2 id="Log"><a href="#Log" class="headerlink" title="Log"></a>Log</h2><h3 id="Done"><a href="#Done" class="headerlink" title="Done"></a>Done</h3><div>
            <input type="checkbox" disabled checked="checked">fix the bug of EH_Transfer_Funtion.m
          </div>
<div>
            <input type="checkbox" disabled checked="checked">build code by formula derivation
          </div>
<input type="checkbox" disabled > improve the CSI-based algorithm according to Reference

### ToDo

<div>
            <input type="checkbox" disabled >Change the EH-Transfer-Function
          </div>
<div>
            <input type="checkbox" disabled >Change the Channel Path loss
          </div>
<h2 id="Channel-Path-Loss"><a href="#Channel-Path-Loss" class="headerlink" title="Channel Path Loss"></a>Channel Path Loss</h2><p>直接搬用OneL的log-distance model：</p>
<div class="code-wrapper"><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> beta <span class="token operator">=</span> <span class="token function">channel_path_loss</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> y2<span class="token punctuation">)</span>
<span class="token comment">%Channel path-loss between device at position (x1,y1) and another device at position (x2,y2)</span>

<span class="token comment">%% Input parameters:</span>
<span class="token comment">% (x1,y1) -> coordinates of the first node</span>
<span class="token comment">% (x2,y2) -> coordinates of the second node</span>

<span class="token comment">%% Output parameters:</span>
<span class="token comment">% beta    -> path-loss between the two nodes at (x1,y1) and (x2,y2)</span>

<span class="token comment">%% The path loss is comupted using the log-distance model</span>
<span class="token comment">% Setting path-loss exponent and attenuation at reference distance of 1m</span>
exponent <span class="token operator">=</span> <span class="token number">2.7</span><span class="token punctuation">;</span>         <span class="token comment">%path loss exponent</span>
attenuation1m <span class="token operator">=</span> <span class="token number">1e-3</span><span class="token punctuation">;</span>   <span class="token comment">%average power attenuation at 1m</span>
<span class="token comment">% Path loss computation</span>
beta <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>attenuation1m<span class="token operator">*</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x1 <span class="token operator">-</span> x2<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token punctuation">(</span>y1 <span class="token operator">-</span> y2<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">.^</span><span class="token operator">-</span>exponent<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<p>返回一个系数beta作为路径衰落。随相对距离Distance的指数衰减（但是我没有找到论文或者表述来描述这个所谓的log-distance model）</p>
<p>防止在Distance=0时beta&gt;1，所以有一个<script type="math/tex">\min(\cdot)</script>。</p>
<h2 id="Channel-Model"><a href="#Channel-Model" class="headerlink" title="Channel Model"></a>Channel Model</h2><h3 id="Channel"><a href="#Channel" class="headerlink" title="Channel"></a>Channel</h3><p>准静态信道，也是几乎所有OneL文章使用的模型，分为直射信道（LoS）和非直射信道（NLoS）</p>
<div class="code-wrapper"><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> h <span class="token operator">=</span> <span class="token function">RicianFadingChannel</span><span class="token punctuation">(</span>kappa<span class="token punctuation">,</span>M<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span> choice<span class="token punctuation">)</span> 
    phi <span class="token operator">=</span> <span class="token function">atan</span><span class="token punctuation">(</span>y<span class="token operator">/</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 发射角度</span>
    Phi <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span>M<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>phi<span class="token punctuation">)</span><span class="token punctuation">;</span>
    h_los <span class="token operator">=</span> <span class="token function">PreventiveAdjustmentofMeanShift</span><span class="token punctuation">(</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token number">1i</span><span class="token operator">.*</span>Phi<span class="token operator">.'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> M<span class="token punctuation">,</span> choice<span class="token punctuation">)</span><span class="token punctuation">;</span>
    hnlos <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">randn</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1i</span><span class="token operator">*</span><span class="token function">randn</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    h <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>kappa<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>kappa<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span>h_los<span class="token operator">*</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token number">1i</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>kappa<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span>hnlos<span class="token punctuation">;</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<h3 id="Preventive-Adjustment-of-Mean-Shift"><a href="#Preventive-Adjustment-of-Mean-Shift" class="headerlink" title="Preventive Adjustment of Mean Shift"></a>Preventive Adjustment of Mean Shift</h3><p>同时考虑到Preventive Adjustment of Mean Shift，有：</p>
<div class="code-wrapper"><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> h <span class="token operator">=</span> <span class="token function">PreventiveAdjustmentofMeanShift</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> M<span class="token punctuation">,</span> choice<span class="token punctuation">)</span>
<span class="token comment">% M: Antennas</span>
    <span class="token keyword">switch</span> choice
        <span class="token keyword">case</span> <span class="token string">'mean'</span>
            varphi <span class="token operator">=</span> <span class="token function">mod</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span>M<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token punctuation">;</span>
            h <span class="token operator">=</span> h<span class="token operator">.*</span><span class="token punctuation">(</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token number">1i</span><span class="token operator">*</span>varphi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.'</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">'variance'</span>
            h <span class="token operator">=</span> h<span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">'none'</span>
            h <span class="token operator">=</span> h<span class="token punctuation">;</span>
        <span class="token keyword">otherwise</span>
            <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'not implement, only mean or variance'</span><span class="token punctuation">)</span> 
    <span class="token keyword">end</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<p>choice可以选择：</p>
<ul>
<li>mean: 即文章<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="O. L. A. López, S. Montejo-Sánchez, R. D. Souza, C. B. Papadias and H. Alves, “On CSI-Free Multiantenna Schemes for Massive RF Wireless Energy Transfer,” in IEEE Internet of Things Journal, vol. 8, no. 1, pp. 278-296, 1 Jan.1, 2021, doi: 10.1109/JIOT.2020.3003114.
">[2]</span></a></sup>中介绍的max-E的优化策略，相邻天线之间相移<script type="math/tex">\pi</script></li>
<li>variance: 即文章<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="O. L. A. López, S. Montejo-Sánchez, R. D. Souza, C. B. Papadias and H. Alves, “On CSI-Free Multiantenna Schemes for Massive RF Wireless Energy Transfer,” in IEEE Internet of Things Journal, vol. 8, no. 1, pp. 278-296, 1 Jan.1, 2021, doi: 10.1109/JIOT.2020.3003114.
">[2]</span></a></sup>中介绍的min-variance的优化策略，相邻天线之间没有相移</li>
</ul>
<h2 id="EH-Transfer-Function"><a href="#EH-Transfer-Function" class="headerlink" title="EH Transfer Function"></a>EH Transfer Function</h2><div class="code-wrapper"><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> harvested_energy <span class="token operator">=</span> <span class="token function">EH_transfer_function</span><span class="token punctuation">(</span>RF_energy<span class="token punctuation">,</span>sensitivity<span class="token punctuation">,</span>saturation<span class="token punctuation">,</span>efficiency<span class="token punctuation">)</span>
<span class="token comment">%EH transfer function given RF energy input and EH hardware parameters [REF]</span>

<span class="token comment">%% Input parameters:</span>
<span class="token comment">% RF_energy    -> RF energy available at the input of the EH circuit </span>
<span class="token comment">% sensitivity  -> RF sensitivity level of the EH circuit</span>
<span class="token comment">% saturation   -> RF saturation level of the EH circuit</span>
<span class="token comment">% efficiency   -> EH conversion efficiency of the EH circuit (scalar between 0 and 1)</span>

<span class="token comment">%% Output parameters:</span>
<span class="token comment">% harvested_energy    -> harvested energy</span>

<span class="token comment">%% Main code</span>
<span class="token comment">%A linear EH transfer function but including sensitivity and saturation phenomena is used here [REF]</span>
harvested_energy <span class="token operator">=</span> efficiency<span class="token operator">*</span><span class="token punctuation">(</span>RF_energy<span class="token operator">.*</span><span class="token punctuation">(</span>RF_energy<span class="token operator">>=</span>sensitivity <span class="token operator">&amp;</span> RF_energy<span class="token operator">&lt;</span>saturation<span class="token punctuation">)</span><span class="token operator">+</span>saturation<span class="token operator">*</span><span class="token punctuation">(</span>RF_energy<span class="token operator">>=</span>saturation<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%Other, more evolved, EH transfer functions can be tested by modifying line 15</span>

<span class="token comment">%[REF]    - O. L. A. L髉ez, et al., "Statistical Analysis of Multiple Antenna</span>
<span class="token comment">%           Strategies for Wireless Energy Transfer," in IEEE Transactions on </span>
<span class="token comment">%           Communications, vol. 67, no. 10, pp. 7245-7262, Oct. 2019.</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<blockquote>
<p>OneL少考虑了Energy=saturation的特殊情况</p>
</blockquote>
<h2 id="CSI-Free"><a href="#CSI-Free" class="headerlink" title="CSI-Free"></a>CSI-Free</h2><h3 id="AA-IS"><a href="#AA-IS" class="headerlink" title="AA-IS"></a>AA-IS</h3><div class="code-wrapper"><pre class="line-numbers language-MATLAB" data-language="MATLAB"><code class="language-MATLAB">function energy &#x3D; AA_IS(kappa, M, x, y, sensitivity, saturation, efficiency)
    h &#x3D; RicianFadingChannel(kappa, M, x, y, &#39;none&#39;);
    RF_energy &#x3D; channel_path_loss(x, 0, y, 0)&#x2F;M*norm(conj(h), 2)^2;
    energy &#x3D; EH_Transfer_Function(RF_energy, sensitivity, saturation, efficiency);
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<p>如参考文献<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="O. L. A. López, S. Montejo-Sánchez, R. D. Souza, C. B. Papadias and H. Alves, “On CSI-Free Multiantenna Schemes for Massive RF Wireless Energy Transfer,” in IEEE Internet of Things Journal, vol. 8, no. 1, pp. 278-296, 1 Jan.1, 2021, doi: 10.1109/JIOT.2020.3003114.
">[2]</span></a></sup>中建模<strong>eqn:10</strong>，假设所有发射机的能量：</p>
<script type="math/tex; mode=display">
E=g(\frac{\beta}{M}||\textbf{h}^*||^2)</script><p>其中，<script type="math/tex">\beta</script>是考虑路径损耗和总发射功率后，在接收端可用的功率，<script type="math/tex">M</script>是总的天线个数，<script type="math/tex">h_i</script>是第<script type="math/tex">i</script>个天线到EH的信道。</p>
<h3 id="SA"><a href="#SA" class="headerlink" title="SA"></a>SA</h3><div class="code-wrapper"><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> energy <span class="token operator">=</span> <span class="token function">AA_SA</span><span class="token punctuation">(</span>kappa<span class="token punctuation">,</span> M<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> sensitivity<span class="token punctuation">,</span> saturation<span class="token punctuation">,</span> efficiency<span class="token punctuation">)</span>
    h <span class="token operator">=</span> <span class="token function">RicianFadingChannel</span><span class="token punctuation">(</span>kappa<span class="token punctuation">,</span> M<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    energy <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> ii<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span>M
        energy <span class="token operator">=</span> energy<span class="token operator">+</span><span class="token function">EH_Transfer_Function</span><span class="token punctuation">(</span><span class="token function">channel_path_loss</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">h</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span> sensitivity<span class="token punctuation">,</span> saturation<span class="token punctuation">,</span> efficiency<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    energy <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span>M<span class="token operator">*</span>energy<span class="token punctuation">;</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<p>如参考文献<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="O. L. A. López, S. Montejo-Sánchez, R. D. Souza, C. B. Papadias and H. Alves, “On CSI-Free Multiantenna Schemes for Massive RF Wireless Energy Transfer,” in IEEE Internet of Things Journal, vol. 8, no. 1, pp. 278-296, 1 Jan.1, 2021, doi: 10.1109/JIOT.2020.3003114.
">[2]</span></a></sup>中建模<strong>eqn:12</strong>或者参考文献<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="O. L. A. López, H. Alves, R. D. Souza and S. Montejo-Sánchez, “Statistical Analysis of Multiple Antenna Strategies for Wireless Energy Transfer,” in IEEE Transactions on Communications, vol. 67, no. 10, pp. 7245-7262, Oct. 2019, doi: 10.1109/TCOMM.2019.2928542.
">[3]</span></a></sup>中的<strong>eqn:15</strong>，假设所有发射机的能量：</p>
<script type="math/tex; mode=display">
E = \frac{1}{M}\sum\limits_{i=1}^Mg(\beta|h^*_i|^2)</script><p>值得注意的是，因为每根天线的持续时间为原始的<script type="math/tex">1/M</script>，所以其求和和平均在Energy Transfer Function <script type="math/tex">g(\cdot)</script>之外。</p>
<h3 id="AA-SS"><a href="#AA-SS" class="headerlink" title="AA-SS"></a>AA-SS</h3><div class="code-wrapper"><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> energy <span class="token operator">=</span> <span class="token function">AA_SS_maxE</span><span class="token punctuation">(</span>kappa<span class="token punctuation">,</span> M<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> sensitivity<span class="token punctuation">,</span> saturation<span class="token punctuation">,</span> efficiency<span class="token punctuation">)</span>
    h <span class="token operator">=</span> <span class="token function">RicianFadingChannel</span><span class="token punctuation">(</span>kappa<span class="token punctuation">,</span> M<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token string">'mean'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    RF_energy <span class="token operator">=</span> <span class="token function">channel_path_loss</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">/</span>M<span class="token operator">*</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>
    energy <span class="token operator">=</span> <span class="token function">EH_Transfer_Function</span><span class="token punctuation">(</span>RF_energy<span class="token punctuation">,</span> sensitivity<span class="token punctuation">,</span> saturation<span class="token punctuation">,</span> efficiency<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>



<span class="token keyword">function</span> energy <span class="token operator">=</span> <span class="token function">AA_SS_minVar</span><span class="token punctuation">(</span>kappa<span class="token punctuation">,</span> M<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> sensitivity<span class="token punctuation">,</span> saturation<span class="token punctuation">,</span> efficiency<span class="token punctuation">)</span>
    h <span class="token operator">=</span> <span class="token function">RicianFadingChannel</span><span class="token punctuation">(</span>kappa<span class="token punctuation">,</span> M<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token string">'variance'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    RF_energy <span class="token operator">=</span> <span class="token function">channel_path_loss</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">/</span>M<span class="token operator">*</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>
    energy <span class="token operator">=</span> <span class="token function">EH_Transfer_Function</span><span class="token punctuation">(</span>RF_energy<span class="token punctuation">,</span> sensitivity<span class="token punctuation">,</span> saturation<span class="token punctuation">,</span> efficiency<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<p>根据参考文献<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="O. L. A. López, S. Montejo-Sánchez, R. D. Souza, C. B. Papadias and H. Alves, “On CSI-Free Multiantenna Schemes for Massive RF Wireless Energy Transfer,” in IEEE Internet of Things Journal, vol. 8, no. 1, pp. 278-296, 1 Jan.1, 2021, doi: 10.1109/JIOT.2020.3003114.
">[2]</span></a></sup><strong>eqn:8</strong>或者参考文献<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="O. L. A. López, H. Alves, R. D. Souza and S. Montejo-Sánchez, “Statistical Analysis of Multiple Antenna Strategies for Wireless Energy Transfer,” in IEEE Transactions on Communications, vol. 67, no. 10, pp. 7245-7262, Oct. 2019, doi: 10.1109/TCOMM.2019.2928542.
">[3]</span></a></sup>的<strong>eqn:14</strong>：</p>
<script type="math/tex; mode=display">
E = g(\frac{\beta}{M}|\sum\limits_{i=1}^Mh_i|^2)=g(\frac{\beta}{M}|\textbf{1}^T\textbf{h}^*|^2)</script><h3 id="APS-EMW"><a href="#APS-EMW" class="headerlink" title="APS-EMW"></a>APS-EMW</h3><div class="code-wrapper"><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> energy <span class="token operator">=</span> <span class="token function">APS_EMW</span><span class="token punctuation">(</span>kappa<span class="token punctuation">,</span> M<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> sensitivity<span class="token punctuation">,</span> saturation<span class="token punctuation">,</span> efficiency<span class="token punctuation">)</span>
    h <span class="token operator">=</span> <span class="token function">RicianFadingChannel</span><span class="token punctuation">(</span>kappa<span class="token punctuation">,</span> M<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
    h <span class="token operator">=</span> h<span class="token operator">.*</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token number">1i</span><span class="token operator">*</span><span class="token function">randn</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token punctuation">)</span><span class="token operator">.*</span><span class="token function">randn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 幅度和相位都要乘一个随机数，且幅度随机数以用户为单位，相位随机数以天线为单位</span>
    RF_energy <span class="token operator">=</span> <span class="token function">channel_path_loss</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">/</span>M<span class="token operator">*</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">;</span>
    energy <span class="token operator">=</span> <span class="token function">EH_Transfer_Function</span><span class="token punctuation">(</span>RF_energy<span class="token punctuation">,</span> sensitivity<span class="token punctuation">,</span> saturation<span class="token punctuation">,</span> efficiency<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<p>根据参考文献<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="B. Clerckx and J. Kim, “On the Beneficial Roles of Fading and Transmit Diversity in Wireless Power Transfer With Nonlinear Energy Harvesting,” in IEEE Transactions on Wireless Communications, vol. 17, no. 11, pp. 7731-7743, Nov. 2018, doi: 10.1109/TWC.2018.2870377.
">[4]</span></a></sup><strong>eqn:14</strong>，有：</p>
<script type="math/tex; mode=display">
y(t)=\sqrt{\frac{2P}{M}}\Re\{\varLambda^{-\frac{1}{2}}h(t)e^{jw_0t}\}</script><p>其中的时变信道<script type="math/tex">h(t)</script>有：</p>
<script type="math/tex; mode=display">
h(t)=\sum\limits_{m=1}^Mh_me^{j\psi_m(t)}</script><p>其中的<script type="math/tex">\psi_m(t)</script>是一个时变的相位，控制信道的时变。</p>
<blockquote>
<p>快衰信道体现在幅度和相位的变化，所以在信道幅度上乘一个randn(N,1)，因为假设对N个用户中任意一个用户而言信道是准静态的；对于相位则是每根天线有一个随机相位randn(M,1)</p>
</blockquote>
<h3 id="Plot-Space"><a href="#Plot-Space" class="headerlink" title="Plot Space"></a>Plot Space</h3><div class="code-wrapper"><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">clc<span class="token punctuation">;</span>clear<span class="token punctuation">;</span>close all<span class="token punctuation">;</span>
M <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
kappa <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
kappa <span class="token operator">=</span> <span class="token number">10.</span><span class="token operator">^</span><span class="token punctuation">(</span>kappa<span class="token operator">./</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
R <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span>
sensitivity <span class="token operator">=</span> <span class="token number">10.</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">22</span><span class="token operator">-</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%-22dBm</span>
saturation <span class="token operator">=</span> <span class="token number">10.</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">8</span><span class="token operator">-</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">%-8dBm</span>
efficiency <span class="token operator">=</span> <span class="token number">0.35</span><span class="token punctuation">;</span>               <span class="token comment">%35%</span>


mtkl_epoch <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>


delta <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">;</span>
x <span class="token operator">=</span> <span class="token operator">-</span>R<span class="token operator">:</span>delta<span class="token operator">:</span>R<span class="token punctuation">;</span>
y <span class="token operator">=</span> <span class="token operator">-</span>R<span class="token operator">:</span>delta<span class="token operator">:</span>R<span class="token punctuation">;</span>

E_AA_SS_maxE_all <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">length</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
E_AA_SS_minVar_all <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">length</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
E_AA_IS_all <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">length</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
E_AA_SA_all <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">length</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
E_APS_EMW_all <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">length</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> m <span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span>mtkl_epoch 
    E_AA_SS_maxE <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">length</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    E_AA_SS_minVar <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">length</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    E_AA_IS <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">length</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    E_AA_SA <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">length</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    E_APS_EMW <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">length</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">for</span> idx_x <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">length</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token keyword">for</span> idx_y <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">length</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>
            <span class="token function">E_AA_SS_maxE</span><span class="token punctuation">(</span>idx_x<span class="token punctuation">,</span>idx_y<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">AA_SS_maxE</span><span class="token punctuation">(</span>kappa<span class="token punctuation">,</span> M<span class="token punctuation">,</span> <span class="token function">x</span><span class="token punctuation">(</span>idx_x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">y</span><span class="token punctuation">(</span>idx_y<span class="token punctuation">)</span><span class="token punctuation">,</span> sensitivity<span class="token punctuation">,</span> saturation<span class="token punctuation">,</span> efficiency<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">E_AA_SS_minVar</span><span class="token punctuation">(</span>idx_x<span class="token punctuation">,</span>idx_y<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">AA_SS_minVar</span><span class="token punctuation">(</span>kappa<span class="token punctuation">,</span> M<span class="token punctuation">,</span> <span class="token function">x</span><span class="token punctuation">(</span>idx_x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">y</span><span class="token punctuation">(</span>idx_y<span class="token punctuation">)</span><span class="token punctuation">,</span> sensitivity<span class="token punctuation">,</span> saturation<span class="token punctuation">,</span> efficiency<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">E_AA_IS</span><span class="token punctuation">(</span>idx_x<span class="token punctuation">,</span>idx_y<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">AA_IS</span><span class="token punctuation">(</span>kappa<span class="token punctuation">,</span> M<span class="token punctuation">,</span> <span class="token function">x</span><span class="token punctuation">(</span>idx_x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">y</span><span class="token punctuation">(</span>idx_y<span class="token punctuation">)</span><span class="token punctuation">,</span> sensitivity<span class="token punctuation">,</span> saturation<span class="token punctuation">,</span> efficiency<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">E_AA_SA</span><span class="token punctuation">(</span>idx_x<span class="token punctuation">,</span>idx_y<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">AA_SA</span><span class="token punctuation">(</span>kappa<span class="token punctuation">,</span> M<span class="token punctuation">,</span> <span class="token function">x</span><span class="token punctuation">(</span>idx_x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">y</span><span class="token punctuation">(</span>idx_y<span class="token punctuation">)</span><span class="token punctuation">,</span> sensitivity<span class="token punctuation">,</span> saturation<span class="token punctuation">,</span> efficiency<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">E_APS_EMW</span><span class="token punctuation">(</span>idx_x<span class="token punctuation">,</span>idx_y<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">APS_EMW</span><span class="token punctuation">(</span>kappa<span class="token punctuation">,</span> M<span class="token punctuation">,</span> <span class="token function">x</span><span class="token punctuation">(</span>idx_x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">y</span><span class="token punctuation">(</span>idx_y<span class="token punctuation">)</span><span class="token punctuation">,</span> sensitivity<span class="token punctuation">,</span> saturation<span class="token punctuation">,</span> efficiency<span class="token punctuation">)</span><span class="token punctuation">;</span>
            
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
    E_AA_SS_maxE_all <span class="token operator">=</span> E_AA_SS_maxE_all<span class="token operator">+</span>E_AA_SS_maxE<span class="token punctuation">;</span>
    E_AA_SS_minVar_all <span class="token operator">=</span> E_AA_SS_minVar_all<span class="token operator">+</span>E_AA_SS_minVar<span class="token punctuation">;</span>
    E_AA_IS_all <span class="token operator">=</span> E_AA_IS_all<span class="token operator">+</span>E_AA_IS<span class="token punctuation">;</span>
    E_AA_SA_all <span class="token operator">=</span> E_AA_SA_all<span class="token operator">+</span>E_AA_SA<span class="token punctuation">;</span>
    E_APS_EMW_all <span class="token operator">=</span> E_APS_EMW_all<span class="token operator">+</span>E_APS_EMW<span class="token punctuation">;</span>
    
    clc<span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'monte carlo running %d ...'</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">end</span>
harvest_energy_AA_maxE <span class="token operator">=</span> <span class="token number">10</span><span class="token operator">*</span><span class="token function">log10</span><span class="token punctuation">(</span>E_AA_SS_maxE_all<span class="token operator">/</span>mtkl_epoch<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">;</span>
harvest_energy_AA_minVar <span class="token operator">=</span> <span class="token number">10</span><span class="token operator">*</span><span class="token function">log10</span><span class="token punctuation">(</span>E_AA_SS_minVar_all<span class="token operator">/</span>mtkl_epoch<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">;</span>
harvest_energy_IS <span class="token operator">=</span> <span class="token number">10</span><span class="token operator">*</span><span class="token function">log10</span><span class="token punctuation">(</span>E_AA_IS_all<span class="token operator">/</span>mtkl_epoch<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">;</span>
harvest_energy_SA <span class="token operator">=</span> <span class="token number">10</span><span class="token operator">*</span><span class="token function">log10</span><span class="token punctuation">(</span>E_AA_SA_all<span class="token operator">/</span>mtkl_epoch<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">;</span>
harvest_energy_APS_EMW <span class="token operator">=</span> <span class="token number">10</span><span class="token operator">*</span><span class="token function">log10</span><span class="token punctuation">(</span>E_APS_EMW_all<span class="token operator">/</span>mtkl_epoch<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">;</span>

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> harvest_energy_AA_maxE<span class="token operator">.'</span><span class="token punctuation">)</span>
<span class="token function">colormap</span><span class="token punctuation">(</span><span class="token function">flipud</span><span class="token punctuation">(</span>hot<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'Distance X /m'</span><span class="token punctuation">)</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'Distance Y /m'</span><span class="token punctuation">)</span>
<span class="token function">zlabel</span><span class="token punctuation">(</span><span class="token string">'Energy /dBW'</span><span class="token punctuation">)</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'AA-SS_&#123;maxE&#125;  Strategy'</span><span class="token punctuation">)</span>

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> harvest_energy_AA_minVar<span class="token operator">.'</span><span class="token punctuation">)</span>
<span class="token function">colormap</span><span class="token punctuation">(</span><span class="token function">flipud</span><span class="token punctuation">(</span>hot<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'Distance X /m'</span><span class="token punctuation">)</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'Distance Y /m'</span><span class="token punctuation">)</span>
<span class="token function">zlabel</span><span class="token punctuation">(</span><span class="token string">'Energy /dBW'</span><span class="token punctuation">)</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'AA-SS_&#123;minVar&#125;  Strategy'</span><span class="token punctuation">)</span>

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> harvest_energy_IS<span class="token operator">.'</span><span class="token punctuation">)</span>
<span class="token function">colormap</span><span class="token punctuation">(</span><span class="token function">flipud</span><span class="token punctuation">(</span>hot<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'Distance X /m'</span><span class="token punctuation">)</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'Distance Y /m'</span><span class="token punctuation">)</span>
<span class="token function">zlabel</span><span class="token punctuation">(</span><span class="token string">'Energy /dBW'</span><span class="token punctuation">)</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'AA-IS  Strategy'</span><span class="token punctuation">)</span>

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> harvest_energy_SA<span class="token operator">.'</span><span class="token punctuation">)</span>
<span class="token function">colormap</span><span class="token punctuation">(</span><span class="token function">flipud</span><span class="token punctuation">(</span>hot<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'Distance X /m'</span><span class="token punctuation">)</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'Distance Y /m'</span><span class="token punctuation">)</span>
<span class="token function">zlabel</span><span class="token punctuation">(</span><span class="token string">'Energy /dBW'</span><span class="token punctuation">)</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'AA-SA  Strategy'</span><span class="token punctuation">)</span>

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> harvest_energy_APS_EMW<span class="token operator">.'</span><span class="token punctuation">)</span>
<span class="token function">colormap</span><span class="token punctuation">(</span><span class="token function">flipud</span><span class="token punctuation">(</span>hot<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'Distance X /m'</span><span class="token punctuation">)</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'Distance Y /m'</span><span class="token punctuation">)</span>
<span class="token function">zlabel</span><span class="token punctuation">(</span><span class="token string">'Energy /dBW'</span><span class="token punctuation">)</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'APS_EMW  Strategy'</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<h3 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h3><p><img src="https://mymarkdown-pic.oss-cn-chengdu.aliyuncs.com/img441/image-20220424145451687.png" srcset="/img/loading.gif" lazyload alt="image-20220424145451687"></p>
<ul>
<li>AA-IS和AA-SA还是不太一样，这个主要原因是因为EH-Transfer-Function是非线性造成的。</li>
</ul>
<h2 id="CSI-Based"><a href="#CSI-Based" class="headerlink" title="CSI-Based"></a>CSI-Based</h2><h3 id="Optimizer"><a href="#Optimizer" class="headerlink" title="Optimizer"></a>Optimizer</h3><div class="code-wrapper"><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> W <span class="token operator">=</span> <span class="token function">CSI_EB_optimizer</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> beta<span class="token punctuation">)</span>
    <span class="token punctuation">[</span>M<span class="token punctuation">,</span> N<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cvx_startup
    cvx_begin sdp quiet
        variable <span class="token function">W</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span>M<span class="token punctuation">)</span> hermitian semidefinite
        variable t
        <span class="token function">minimize</span><span class="token punctuation">(</span><span class="token operator">-</span>t<span class="token punctuation">)</span>   
        subject to
            <span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>N           
                <span class="token function">beta</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">real</span><span class="token punctuation">(</span><span class="token function">trace</span><span class="token punctuation">(</span>W<span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">h</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">h</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">>=</span> t<span class="token punctuation">;</span>
            <span class="token keyword">end</span>
            <span class="token function">trace</span><span class="token punctuation">(</span>W<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">;</span>
    cvx_end
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<p>完全按照参考文献<sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><span class="hint--top hint--rounded" aria-label="O. L. A. López, F. A. Monteiro, H. Alves, R. Zhang and M. Latva-Aho, “A Low-Complexity Beamforming Design for Multiuser Wireless Energy Transfer,” in IEEE Wireless Communications Letters, vol. 10, no. 1, pp. 58-62, Jan. 2021, doi: 10.1109/LWC.2020.3020576.
">[5]</span></a></sup>进行设计</p>
<h3 id="Compute-Energy"><a href="#Compute-Energy" class="headerlink" title="Compute Energy"></a>Compute Energy</h3><div class="code-wrapper"><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> E <span class="token operator">=</span> <span class="token function">compute_energy</span><span class="token punctuation">(</span>W<span class="token punctuation">,</span> h<span class="token punctuation">,</span> beta<span class="token punctuation">)</span>
    <span class="token punctuation">[</span>M <span class="token punctuation">,</span> N<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">[</span>U<span class="token punctuation">,</span> S<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">eig</span><span class="token punctuation">(</span>W<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">S</span><span class="token punctuation">(</span>S<span class="token operator">&lt;</span><span class="token number">10e-5</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    r <span class="token operator">=</span> <span class="token function">rank</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>r    
        <span class="token function">w</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">U</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> M<span class="token operator">-</span>r<span class="token operator">+</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">.'</span><span class="token punctuation">;</span>
        <span class="token function">w</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">j</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">w</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">norm</span><span class="token punctuation">(</span><span class="token function">w</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">j</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    E <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span>N
       <span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span>r
           <span class="token function">E</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">E</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">beta</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">S</span><span class="token punctuation">(</span>M<span class="token operator">-</span>r<span class="token operator">+</span><span class="token number">j</span><span class="token punctuation">,</span> M<span class="token operator">-</span>r<span class="token operator">+</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">h</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">i</span><span class="token punctuation">)</span><span class="token string">'*w(:,j)*w(:,j)'</span><span class="token operator">*</span><span class="token function">h</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">end</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<p>注意这里用特征值代表对应<script type="math/tex">\textbf{w}</script>持续的时间，能量为：</p>
<p><img src="https://mymarkdown-pic.oss-cn-chengdu.aliyuncs.com/img441/image-20220424175207762.png" srcset="/img/loading.gif" lazyload alt="image-20220424175207762" style="zoom: 67%;" /></p>
<h3 id="Plot-Space-1"><a href="#Plot-Space-1" class="headerlink" title="Plot Space"></a>Plot Space</h3><div class="code-wrapper"><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">clc<span class="token punctuation">;</span>clear<span class="token punctuation">;</span>close all<span class="token punctuation">;</span>
M <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">;</span>
N <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>
R <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
Kappa_dB <span class="token operator">=</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">5</span><span class="token operator">:</span><span class="token number">30</span><span class="token punctuation">;</span>         <span class="token comment">%LOS factor (in dB) of the Rician fading</span>
Kappa <span class="token operator">=</span> <span class="token number">10.</span><span class="token operator">^</span><span class="token punctuation">(</span>Kappa_dB<span class="token operator">./</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">% 假设用户均匀分布在半径为R的圆周上。</span>
phi <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">/</span>N<span class="token operator">:</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">/</span>N<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token punctuation">;</span>
Phi <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span>M<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">'</span><span class="token operator">.*</span><span class="token keyword">pi</span><span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>phi<span class="token punctuation">)</span><span class="token punctuation">;</span>
x <span class="token operator">=</span> R<span class="token operator">*</span><span class="token function">cos</span><span class="token punctuation">(</span>phi<span class="token punctuation">)</span><span class="token punctuation">;</span>
y <span class="token operator">=</span> R<span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>phi<span class="token punctuation">)</span><span class="token punctuation">;</span>

mtkl_epoch <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
E_full_performance <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">length</span><span class="token punctuation">(</span>Kappa<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
E_Statistical_performance <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">length</span><span class="token punctuation">(</span>Kappa<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">for</span> k <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span><span class="token function">length</span><span class="token punctuation">(</span>Kappa<span class="token punctuation">)</span> 
    kappa <span class="token operator">=</span> <span class="token function">Kappa</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
    E_full_min <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    E_Statistical_min <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> m<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span>mtkl_epoch
        clc<span class="token punctuation">;</span>
        <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'\nkappa = %d, epoch: %d/%d\n'</span><span class="token punctuation">,</span> kappa<span class="token punctuation">,</span> m<span class="token punctuation">,</span> mtkl_epoch<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">% channel</span>
        h_los <span class="token operator">=</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token number">1i</span><span class="token operator">.*</span>Phi<span class="token punctuation">)</span><span class="token punctuation">;</span>
        h_nlos <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">randn</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1i</span><span class="token operator">*</span><span class="token function">randn</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

        h_bar <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>kappa<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>kappa<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.*</span>h_los<span class="token operator">.*</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token number">1i</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        h_hat <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>kappa<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.*</span>h_nlos<span class="token punctuation">;</span>
        h <span class="token operator">=</span> h_hat<span class="token operator">+</span>h_bar<span class="token punctuation">;</span>
        <span class="token comment">% compute the path loss</span>
        beta <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token number">i</span> <span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span>N
            <span class="token function">beta</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">channel_path_loss</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>

        <span class="token comment">% W=ww' with full CSI</span>
        W_full <span class="token operator">=</span> <span class="token function">CSI_EB_optimizer</span><span class="token punctuation">(</span>h_hat<span class="token operator">+</span>h_bar<span class="token punctuation">,</span> beta<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">% W=ww' with statistical CSI</span>
        W_Statistical<span class="token operator">=</span> <span class="token function">CSI_EB_optimizer</span><span class="token punctuation">(</span>h_bar<span class="token punctuation">,</span> beta<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">% compute energy by W1</span>
        E_full <span class="token operator">=</span> <span class="token function">compute_energy</span><span class="token punctuation">(</span>W_full<span class="token punctuation">,</span> h<span class="token punctuation">,</span> beta<span class="token punctuation">)</span><span class="token punctuation">;</span>
        E_full_min <span class="token operator">=</span> E_full_min <span class="token operator">+</span> <span class="token function">min</span><span class="token punctuation">(</span>E_full<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">% compute energy by W2</span>
        E_Statistical <span class="token operator">=</span> <span class="token function">compute_energy</span><span class="token punctuation">(</span>W_Statistical<span class="token punctuation">,</span> h<span class="token punctuation">,</span> beta<span class="token punctuation">)</span><span class="token punctuation">;</span>
        E_Statistical_min <span class="token operator">=</span> E_Statistical_min <span class="token operator">+</span> <span class="token function">min</span><span class="token punctuation">(</span>E_Statistical<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    <span class="token function">E_full_performance</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">=</span> E_full_min<span class="token operator">/</span>mtkl_epoch<span class="token punctuation">;</span>
    <span class="token function">E_Statistical_performance</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">=</span> E_Statistical_min<span class="token operator">/</span>mtkl_epoch<span class="token punctuation">;</span>
<span class="token keyword">end</span>
fCSI <span class="token operator">=</span> <span class="token number">10</span><span class="token operator">*</span><span class="token function">log10</span><span class="token punctuation">(</span>E_Statistical_performance<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">;</span>
aCSI <span class="token operator">=</span> <span class="token number">10</span><span class="token operator">*</span><span class="token function">log10</span><span class="token punctuation">(</span>E_full_performance<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">;</span>

<span class="token comment">%% Figure generation</span>
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token function">set</span><span class="token punctuation">(</span>gcf<span class="token punctuation">,</span> <span class="token string">'Units'</span><span class="token punctuation">,</span> <span class="token string">'centimeters'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
axesFontSize <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>
legendFontSize <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>
afFigurePosition <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span> <span class="token number">7</span> <span class="token number">19</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
<span class="token function">set</span><span class="token punctuation">(</span>gcf<span class="token punctuation">,</span> <span class="token string">'Position'</span><span class="token punctuation">,</span> afFigurePosition<span class="token punctuation">,</span><span class="token string">'PaperSize'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">18</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'PaperPositionMode'</span><span class="token punctuation">,</span><span class="token string">'auto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token function">plot</span><span class="token punctuation">(</span>Kappa_dB<span class="token punctuation">,</span> fCSI<span class="token punctuation">,</span><span class="token string">'-ok'</span><span class="token punctuation">,</span><span class="token string">'MarkerSize'</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">'LineWidth'</span><span class="token punctuation">,</span><span class="token number">2.5</span><span class="token punctuation">)</span>
hold on
<span class="token function">plot</span><span class="token punctuation">(</span>Kappa_dB<span class="token punctuation">,</span> aCSI<span class="token punctuation">,</span><span class="token string">'-sk'</span><span class="token punctuation">,</span><span class="token string">'MarkerSize'</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">'LineWidth'</span><span class="token punctuation">,</span><span class="token number">2.5</span><span class="token punctuation">)</span>
hold on

<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'$\kappa$ (dB)'</span><span class="token punctuation">,</span><span class="token string">'Interpreter'</span><span class="token punctuation">,</span> <span class="token string">'latex'</span><span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span>axesFontSize<span class="token punctuation">)</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'average worst-case RF energy (dBm)'</span><span class="token punctuation">,</span><span class="token string">'Interpreter'</span><span class="token punctuation">,</span> <span class="token string">'latex'</span><span class="token punctuation">,</span><span class="token string">'fontsize'</span><span class="token punctuation">,</span>axesFontSize<span class="token punctuation">)</span>
hl<span class="token operator">=</span><span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">'full CSI EB'</span><span class="token punctuation">,</span><span class="token string">'LOS-based CSI'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">set</span><span class="token punctuation">(</span>hl<span class="token punctuation">,</span><span class="token string">'FontSize'</span><span class="token punctuation">,</span>legendFontSize<span class="token punctuation">,</span><span class="token string">'interpreter'</span><span class="token punctuation">,</span><span class="token string">'latex'</span><span class="token punctuation">)</span>

<span class="token function">set</span><span class="token punctuation">(</span>gca<span class="token punctuation">,</span><span class="token string">'FontSize'</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span>
box on
grid on<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<p>与Onel在论文中的设置不一样，由于Onel在论文中的设置是，在<script type="math/tex">R</script>为半径的圆内EH Receiver 随机分布，取其中最差的结果作为性能指标。这样随机性太大了</p>
<p>我的想法是以<script type="math/tex">R</script>为半径，均匀分布在圆周上，并取其中最差的结果作为衡量指标，这样结果比较稳定。结果见下节。</p>
<h3 id="Result-1"><a href="#Result-1" class="headerlink" title="Result"></a>Result</h3><p><img src="https://mymarkdown-pic.oss-cn-chengdu.aliyuncs.com/img441/result2.jpg" srcset="/img/loading.gif" lazyload alt="result2" style="zoom:50%;" /></p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a target="_blank" rel="noopener" href="https://github.com/onel2428/WEToverview">https://github.com/onel2428/WEToverview</a>
<a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><script type="math/tex; mode=display">
\textbf{h}=\sqrt{\frac{\kappa}{1+\kappa}}e^{\text{i}\varphi_0}\textbf{h}_{\text{los}}+\sqrt{\frac{1}{\kappa+1}}\textbf{h}_{\text{nlos}}</script><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span>O. L. A. López, S. Montejo-Sánchez, R. D. Souza, C. B. Papadias and H. Alves, “On CSI-Free Multiantenna Schemes for Massive RF Wireless Energy Transfer,” in IEEE Internet of Things Journal, vol. 8, no. 1, pp. 278-296, 1 Jan.1, 2021, doi: 10.1109/JIOT.2020.3003114.
<a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span>O. L. A. López, H. Alves, R. D. Souza and S. Montejo-Sánchez, “Statistical Analysis of Multiple Antenna Strategies for Wireless Energy Transfer,” in IEEE Transactions on Communications, vol. 67, no. 10, pp. 7245-7262, Oct. 2019, doi: 10.1109/TCOMM.2019.2928542.
<a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:4" class="footnote-text"><span>B. Clerckx and J. Kim, “On the Beneficial Roles of Fading and Transmit Diversity in Wireless Power Transfer With Nonlinear Energy Harvesting,” in IEEE Transactions on Wireless Communications, vol. 17, no. 11, pp. 7731-7743, Nov. 2018, doi: 10.1109/TWC.2018.2870377.
<a href="#fnref:4" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:5" class="footnote-text"><span>O. L. A. López, F. A. Monteiro, H. Alves, R. Zhang and M. Latva-Aho, “A Low-Complexity Beamforming Design for Multiuser Wireless Energy Transfer,” in IEEE Wireless Communications Letters, vol. 10, no. 1, pp. 58-62, Jan. 2021, doi: 10.1109/LWC.2020.3020576.
<a href="#fnref:5" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:6" class="footnote-text"><span>A. Thudugalage, S. Atapattu and J. Evans, “Beamformer design for wireless energy transfer with fairness,” 2016 IEEE International Conference on Communications (ICC), 2016, pp. 1-6, doi: 10.1109/ICC.2016.7511170.
<a href="#fnref:6" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>
            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/Paper-Reading/">Paper Reading</a>
                    
                      <a class="hover-with-bg" href="/categories/Paper-Reading/Channel-State-Information/">Channel State Information</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Reproduction/">Reproduction</a>
                    
                  </div>
                
              </div>
<!--                -->
<!--                 <p class="note note-warning"> -->
<!--                    -->
<!--                     本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！ -->
<!--                    -->
<!--                 </p> -->
<!--                -->
              <p class="note note-warning">
                <strong>本文作者: </strong><a href="/">Joffrey-Luo Cheng</a> <br>
                <strong>本文链接: </strong><a href="http://lcjoffrey.top/2022/04/24/reproductionofOnel/">http://lcjoffrey.top/2022/04/24/reproductionofOnel/</a> <br>
                <strong>版权声明: </strong>本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                   </p>
              

              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/04/20/BF4WETwithFair/">
                        <span class="hidden-mobile">Max-Min Fair Beamforming->Single & Multiple BF</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/valine@1/dist/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"tmPe0DnmjGqXjaxtJTQB0oVL-gzGzoHsz","appKey":"HN1Lyqbf2l1GoVxq9cSBDzWq","path":"window.location.pathname","placeholder":"说点什么...","avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":true,"recordIP":false,"serverURLs":"https://tmpe0dnm.lc-cn-n1-shared.com","emojiCDN":null,"emojiMaps":null,"enableQQ":false},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          Fluid.plugins.initFancyBox('#valine .vcontent img:not(.vemoji)');
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
      <div class="col-lg-7 mx-auto nopadding-x-md">
        <div class="container custom mx-auto">
          <link rel="stylesheet" href="/dist/APlayer.min.css"> <div id="aplayer"></div> <script type="text/javascript" src="/dist/APlayer.min.js"></script> <script type="text/javascript" src="/js/diy/music.js"></script>
        </div>
      </div>
    
  </main>

  <footer class="text-center mt-5 py-3">
<!-- 
  <div class="music-player">
  <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=483378334&auto=1&height=66"></iframe>
  </div>
-->
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
	<!--《添加网站运行时间 -->
<br/>

<span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
<script>
var now = new Date(); 

function createtime() {
    //此处修改你的建站时间或者网站上线时间
    var grt = new Date('12/1/2021 00:00:00');
    now.setTime(now.getTime() + 250);
    days = (now - grt) / 1000 / 60 / 60 / 24;

    dnum = Math.floor(days);
    hours = (now - grt) / 1000 / 60 / 60 - (24 * dnum);
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
        hnum = "0" + hnum;
    }
    minutes = (now - grt) / 1000 / 60 - (24 * 60 * dnum) - (60 * hnum);
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
        mnum = "0" + mnum;
    }
    seconds = (now - grt) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
        snum = "0" + snum;
    }
    document.getElementById("timeDate").innerHTML = " 🚀&小破站已安全运行 " + dnum + " 天 ";
    document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
}
setInterval("createtime()", 250);
</script>

<!-- 添加网站运行时间》-->

  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  
    
  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>





  

  
    <!-- MathJax -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        loader: {
          load: ['ui/lazy']
        },
        options: {
          renderActions: {
            findScript: [10, doc => {
              document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                const display = !!node.type.match(/; *mode=display/);
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                const text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = { node: text, delim: '', n: 0 };
                math.end = { node: text, delim: '', n: 0 };
                doc.math.push(math);
              });
            }, '', false],
            insertedScript: [200, () => {
              document.querySelectorAll('mjx-container').forEach(node => {
                let target = node.parentNode;
                if (target.nodeName.toLowerCase() === 'li') {
                  target.parentNode.classList.add('has-jax');
                }
              });
            }, '', false]
          }
        }
      };
    </script>

    <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" ></script>

  





  <script  src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js" ></script>
  <script>
    if (window.mermaid) {
      mermaid.initialize(null);
    }
  </script>






  
<script src="/js/diy/caidai.js"></script>



<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
